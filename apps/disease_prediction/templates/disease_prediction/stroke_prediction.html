{% extends 'common/base.html' %}

{% block title %}Stroke Risk Prediction{% endblock %}

{% block content %}
<style>
    .prediction-container {
        max-width: 800px;
        margin: 0 auto;
    }
    
    .form-card {
        background-color: #4D4738 !important;
        border: 3px solid #C0AE94 !important;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 4px 15px rgba(77, 71, 59, 0.3);
    }
    
    .form-card h2 {
        color: #C0AE94 !important;
        font-weight: 600;
        margin-bottom: 30px;
        text-align: center;
    }
    
    .form-label {
        color: #C0AE94 !important;
        font-weight: 500;
        margin-bottom: 8px;
    }
    
    .form-control {
        background-color: #BAB9A7 !important;
        border: 2px solid #C0AE94 !important;
        color: #4D4738 !important;
        border-radius: 8px;
        padding: 10px;
    }
    
    .form-control:focus {
        background-color: #BAB9A7 !important;
        border-color: #755F4A !important;
        box-shadow: 0 0 0 0.2rem rgba(117, 95, 74, 0.25);
        color: #4D4738 !important;
    }
    
    .form-select {
        background-color: #BAB9A7 !important;
        border: 2px solid #C0AE94 !important;
        color: #4D4738 !important;
        border-radius: 8px;
    }
    
    .btn-predict-submit {
        background-color: #755F4A !important;
        color: white !important;
        border: 2px solid #C0AE94 !important;
        border-radius: 8px;
        padding: 12px 40px;
        font-weight: 500;
        width: 100%;
        transition: all 0.3s ease;
    }
    
    .btn-predict-submit:hover {
        background-color: #BAB9A7 !important;
        color: #4D4738 !important;
        border-color: #4D4738 !important;
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(186, 185, 167, 0.4);
    }
    
    .result-card {
        background-color: #4D4738;
        border: 3px solid #C0AE94;
        border-radius: 15px;
        padding: 30px;
        margin-top: 30px;
        text-align: center;
    }
    
    .result-success {
        border-color: #28a745 !important;
    }
    
    .result-danger {
        border-color: #dc3545 !important;
    }
    
    .result-card h3 {
        color: #C0AE94;
        font-weight: 600;
        margin-bottom: 20px;
    }
    
    .result-card .prediction-text {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 15px;
    }
    
    .result-card .risk-text {
        font-size: 1.2rem;
        color: #C0AE94;
    }
    
    .text-success-custom {
        color: #28a745 !important;
    }
    
    .text-danger-custom {
        color: #dc3545 !important;
    }
</style>

<div class="prediction-container">
    <div class="form-card">
        <h2><i class="bi bi-heart-pulse"></i> Stroke Risk Prediction</h2>
        
        <form method="POST">
            {% csrf_token %}
            
<div class="row">
    <div class="col-md-6 mb-3">
        <label class="form-label">Gender</label>
        <select name="gender" class="form-select" required>
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
        </select>
    </div>
    
    <div class="col-md-6 mb-3">
        <label class="form-label">Age (Years)</label>
        <input type="number" name="age" class="form-control" required 
               min="0" max="120" step="0.1" 
               placeholder="0 - 120">
        <small class="text-muted" style="color: #C0AE94 !important;">Range: 0-120 years</small>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-3">
        <label class="form-label">Hypertension</label>
        <select name="hypertension" class="form-select" required>
            <option value="">Select Option</option>
            <option value="0">No</option>
            <option value="1">Yes</option>
        </select>
        <small class="text-muted" style="color: #C0AE94 !important;">Do you have high blood pressure?</small>
    </div>
    
    <div class="col-md-6 mb-3">
        <label class="form-label">Heart Disease</label>
        <select name="heart_disease" class="form-select" required>
            <option value="">Select Option</option>
            <option value="0">No</option>
            <option value="1">Yes</option>
        </select>
        <small class="text-muted" style="color: #C0AE94 !important;">Do you have heart disease?</small>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-3">
        <label class="form-label">Ever Married</label>
        <select name="ever_married" class="form-select" required>
            <option value="">Select Option</option>
            <option value="No">No</option>
            <option value="Yes">Yes</option>
        </select>
    </div>
    
    <div class="col-md-6 mb-3">
        <label class="form-label">Work Type</label>
        <select name="work_type" class="form-select" required>
            <option value="">Select Work Type</option>
            <option value="Private">Private</option>
            <option value="Self-employed">Self-employed</option>
            <option value="Govt_job">Government Job</option>
            <option value="children">Children</option>
            <option value="Never_worked">Never Worked</option>
        </select>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-3">
        <label class="form-label">Residence Type</label>
        <select name="Residence_type" class="form-select" required>
            <option value="">Select Residence Type</option>
            <option value="Urban">Urban</option>
            <option value="Rural">Rural</option>
        </select>
    </div>
    
    <div class="col-md-6 mb-3">
        <label class="form-label">Average Glucose Level (mg/dL)</label>
        <input type="number" name="avg_glucose_level" class="form-control" required 
               min="50" max="500" step="0.01" 
               placeholder="50 - 500">
        <small class="text-muted" style="color: #C0AE94 !important;">Normal: 70-100 (fasting)</small>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-3">
        <label class="form-label">BMI (Body Mass Index)</label>
        <input type="number" name="bmi" class="form-control" required 
               min="10" max="100" step="0.1" 
               placeholder="10 - 100">
        <small class="text-muted" style="color: #C0AE94 !important;">Normal: 18.5-24.9</small>
    </div>
    
    <div class="col-md-6 mb-3">
        <label class="form-label">Smoking Status</label>
        <select name="smoking_status" class="form-select" required>
            <option value="">Select Smoking Status</option>
            <option value="never smoked">Never Smoked</option>
            <option value="formerly smoked">Formerly Smoked</option>
            <option value="smokes">Smokes</option>
            <option value="Unknown">Unknown</option>
        </select>
    </div>
</div>
            
            <button type="submit" class="btn btn-predict-submit mt-3">
                <i class="bi bi-calculator"></i> Predict Stroke Risk
            </button>
        </form>
    </div>
    
    {% if result %}
    <div class="result-card {% if result.status == 'success' %}result-success{% else %}result-danger{% endif %}">
        <h3><i class="bi bi-clipboard2-pulse"></i> Prediction Result</h3>
        
        {% if result.error %}
            <p class="text-danger-custom">Error: {{ result.error }}</p>
        {% else %}
            <p class="prediction-text {% if result.status == 'success' %}text-success-custom{% else %}text-danger-custom{% endif %}">
                {{ result.prediction }}
            </p>
            <p class="risk-text">Risk Probability: <strong>{{ result.risk_percentage }}%</strong></p>
            
            {% if result.status == 'danger' %}
                <p class="text-danger-custom mt-3">
                    <i class="bi bi-exclamation-triangle"></i> High stroke risk detected! Please consult a doctor immediately for proper evaluation.
                </p>
            {% else %}
                <p class="text-success-custom mt-3">
                    <i class="bi bi-check-circle"></i> Keep maintaining a healthy lifestyle and monitor your cardiovascular health!
                </p>
            {% endif %}
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}